{% extends 'base.html' %}
{% load humanize %}

{% block content %}
<div id='app-questionnaire'>
<div class="row justify-content-center my-4">
    <div class="col-lg-8 col-md-10 col-xs-12 pr-4">
        <div class="">
            <h3>{{questionnaire.name}}</h3>
            <p> {{questionnaire.created_at|date:"D d/m/Y"}}</p>
            {{answers}}
        </div>
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-lg-8 col-md-10 col-xs-12">
        <div class="row justify-content-center">
            <div class="col-12 ">
                {% for question in questionnaire.question_set.all %}
                <div class='bg-white rounded shadow p-2 mb-1'>
                    <!--display question and its choices if are closed questions-->
                    <div class="px-3 py-2">
                        <div class="">
                            <h4>{{question.contents}}</h4>
                        </div>
                        <ul>
                            {% for choice in question.choice_set.all %}                         
                                {% if question.type == 'single-choice' %}
                                <div class="custom-control custom-radio">
                                    <input type="radio" id="customRadio-{{choice.id}}" name="customRadio" class="custom-control-input">
                                    <label class="custom-control-label" for="customRadio-{{choice.id}}">{{choice.contents}}</label>
                                  </div>
                                {% elif question.type == 'multiple-choice' %}
                                <div class="custom-control custom-checkbox checkbox-dark">
                                    <input type="checkbox" class="custom-control-input " id="customCheck-{{choice.id}}">
                                    <label class="custom-control-label" for="customCheck-{{choice.id}}">{{choice.contents}}</label>
                                  </div>
                                {% endif %}
                            {% endfor %}

                        </ul>
                        <h6 class="text-success">Moja odpowiedzi :</h6>
                    </div>
                    <div class="px-3">
                    {% for answer in question.answer_set.all %}
                       {% if answer.respondent.user.id == request.user.id %}
                            <div class="px-4 py-1">
                            {% for a in answer.closedanswer_set.all %}
                                <p> <i class="far fa-check-square text-success"></i> {{a.choice.contents}}</p>
                            {% endfor %}
                            </div>
                            {% if answer.question.type == 'text' or answer.question.type == 'number'  %}
                            <div class="form-group border rounded p-2">
                                <p class="">{{answer.openanswer.contents}}</p>
                            </div>
                            {% endif %}

                        {% endif %}
                    {% endfor %}
                    </div>
                </div>
                {% endfor %}
               
            </div>
        </div>
    </div>
</div>
</div>

{% block script %}
<script>
    var appDelete = new Vue({
        el: '#app-questionnaire',
        delimiters:['[[',']]'],
        data(){
            return{
                isYes:false,
            }
        },
        methods: {
            deleteQuestionnaire:function(e){
                this.isYes = confirm("Czy na pewno chcesz usunąć ankiete?")
                console.log(this.isYes)
                if( this.isYes ){
                    this.$refs.form.submit()
                }
                
            }
        },
    })
</script>
{% endblock %}
{% endblock %}